<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.12: http://docutils.sourceforge.net/" />
<title>Analysis of the drug screen</title>
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 7614 2013-02-21 15:55:51Z milde $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

object[type="image/svg+xml"], object[type="application/x-shockwave-flash"] {
  overflow: hidden;
}

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title, .code .error {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left, .figure.align-left, object.align-left {
  clear: left ;
  float: left ;
  margin-right: 1em }

img.align-right, .figure.align-right, object.align-right {
  clear: right ;
  float: right ;
  margin-left: 1em }

img.align-center, .figure.align-center, object.align-center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

.align-left {
  text-align: left }

.align-center {
  clear: both ;
  text-align: center }

.align-right {
  text-align: right }

/* reset inner alignment in figures */
div.align-right {
  text-align: inherit }

/* div.align-center * { */
/*   text-align: left } */

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block, pre.math, pre.code {
  margin-left: 2em ;
  margin-right: 2em }

pre.code .ln { color: grey; } /* line numbers */
pre.code, code { background-color: #eeeeee }
pre.code .comment, code .comment { color: #5C6576 }
pre.code .keyword, code .keyword { color: #3B0D06; font-weight: bold }
pre.code .literal.string, code .literal.string { color: #0C5404 }
pre.code .name.builtin, code .name.builtin { color: #352B84 }
pre.code .deleted, code .deleted { background-color: #DEB0A1}
pre.code .inserted, code .inserted { background-color: #A3D289}

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

/* "booktabs" style (no vertical lines) */
table.docutils.booktabs {
  border: 0px;
  border-top: 2px solid;
  border-bottom: 2px solid;
  border-collapse: collapse;
}
table.docutils.booktabs * {
  border: 0px;
}
table.docutils.booktabs th {
  border-bottom: thin solid;
  text-align: left;
}

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document" id="analysis-of-the-drug-screen">
<h1 class="title">Analysis of the drug screen</h1>

<div class="section" id="first-step-data-set-for-a-new-classifier-for-the-drug-screen-data">
<h1>8/08/2016: First step: data set for a new classifier for the drug screen data</h1>
<p>We have noticed that appliction of the mitocheck-classifier seems to
be sub-optimal. Therefore, I train a new classifier on the drug
data.</p>
<p>First, I had to select the movies. This was done with the help of the
plate views on <a class="reference external" href="http://olympia.biomedicale.univ-paris5.fr/plates/">plateview</a></p>
<p>There I selected spots for different drugs, some spots with no or
little effect (including also empty), most spots however with either
medium or strong effect. The objective is to avoid missing interesting
morphologies. Altogether, I selected 28 conditions, all with 2
fields (56 movies). Each movie was selected in triplicates (from
labteks LT0900_01, LT0900_02, LT0900_05).</p>
</div>
<div class="section" id="technical-issues">
<h1>10/08/2016: Technical issues</h1>
<p>There were several technical issues.</p>
<p>First, the channel naming varied with the plate (either <tt class="docutils literal">Cy3</tt> or
<tt class="docutils literal">b_cy3</tt>). I therefore renamed, so that the channel is now always
<tt class="docutils literal">Cy3</tt>.
This is done with the script <tt class="docutils literal">src/rename_files.py</tt></p>
<p>Second, there is sometimes a high background. In principle, this does
not hurt for the segmentation, as the background is removed. But
CellCognition does a conversion to 8bit images, which is the same for
all movies. Consequently, images with a high background might actually
experience a reduction of the dynamic range. I therefore subtracted
the offset of all images by subtracting the 5%-percentile from each
image <tt class="docutils literal">src/offset_correction.py</tt></p>
</div>
<div class="section" id="annotation-of-morphologies">
<h1>12/08/2016: Annotation of morphologies</h1>
<p>I annotated morphologies, from these movies. Several
observations:</p>
<ul class="simple">
<li>There were conditions in which the prometaphases looked very
different from what has been in the training set. The nuclei were
very small and chromatine very condensed, so that they can be easily
confounded with apoptotic nuclei. This was typically followed by
decondensation (with polylobed or grape shaped nuclei as a
consequence).</li>
<li>There were some conditions, where a particular polylobed morphology
appeared (with a kidney shape). This shape does not seem to relate
to segregation defects, and thus not to mitotic phenotypes. It is
possible that this morphology also exists in the Mitocheck data
set.</li>
<li>There were no dynamic nuclei, no elongated nuclei, very few
binuclear nuclei, few artefact classes (splitting worked nicely!).</li>
<li>As we use a split strategy, it is difficult to detect the polylobed
systematically. Sometimes they are not split however, so that I
could annotate some. This problem has already occurred in the
Mitocheck data set (for which we also applied a split algorithm,
which was necessary for the tracking).</li>
</ul>
<p>This rises a number of questions.</p>
<ol class="arabic simple">
<li>What do we do with classes that are apparently not present (in the
sample I looked at)? Are they maintained in the classifier or do we
just remove them from the profiles (eventually putting them to zero)?</li>
<li>If we maintain classes that were not annotated in the data set,
this would refer to using a combined classifier. For this, we need to
join classifiers by combining arff-files (see below).</li>
<li>Do we reprocess the mitocheck data set (only classification!) in
order to find kidney-shaped nuclei (by a combined classifier)?</li>
</ol>
<p>Regarding question (1), I think that both alternatives can be
tested. For this, I built a classifier with only those morphologies
that were actually present in the drug data set (2420 nuclei). This is
the corresponding classifier (I removed the image data from version
control): <tt class="docutils literal">cecog_classifiers/classifier_2016_08_10_only_observed_classes</tt>.</p>
<p>This is in any case a working solution. The kidney class can be either
removed or joined with polylobed or interphase, or maintained in the
drug-screen data and not in the mitocheck data set. As a matter of
fact, we could argue that this kind of situation is typical when
comparing screens, and that the EMD allows us to compare profiles with
different classes, as long as we can define a cost matrix between the
classes.</p>
<p>In order to build a joined classifier, I wrote a script that joins two
arff files: <tt class="docutils literal">src/join_classifiers.py</tt>. The script is now running,
and a joint classifier has been trained:
<tt class="docutils literal">cecog_classifiers/res_join</tt>. The training phase for this classifier
is relatively long due to the large number of samples.</p>
<p>Finally, we have to decide, what to do with the kidney-shape class. My
feeling is that if we find a new class in the mitocheck data and if
this class allows us to find the molecular targets of this drug, this
will be a strong argument and a nice result. But there are many
&quot;ifs&quot;: it might be that this morphology will actually introduce more
problems than benefits. I think we can take the risk and look what's
coming out.</p>
<p>There are also still some technical issues related to the compilation
on the cluster: the system has been updated, and at the moment
cellcognition does not run because of several dependencies. I
re-compiled qt and PyQt. At the moment I am blocked by lxml (for which
I need the assistance of IT).</p>
<p>The following issues have been settled:</p>
<ul class="simple">
<li>Installation of lxml and its dependencies (done by IT).</li>
<li>Installation of PyQt4.</li>
<li>Installation of PyQt5. This was necessary, as the new version of
CellCognition depends on PyQt5. The Qt-dependency has been installed
in <tt class="docutils literal">/share/apps/user_apps/QT5</tt>. Probably, I should have installed
PyQt4 also to such a dedicated folder, but now it is in
<tt class="docutils literal"><span class="pre">/cbio/donnees/nvaroquaux/.local/</span></tt>. Importantly, the paths need to
point to the QT5 installation if a new version is to be used.</li>
<li>Update of CellCognition to the current version.</li>
</ul>
</div>
<div class="section" id="where-is-the-data-and-everything">
<h1>13/08/2016: Where is the data and everything?</h1>
<p>The original drug data can be found here:
<tt class="docutils literal">/share/data40T/aschoenauer/drug_screen/data_offset_corrected</tt>
As mentioned earlier, this data is offset-corrected and renamed.</p>
<p>I finally managed to start everything on the cluster.
For this, I have removed the PyQt4 installation. I noticed, that a
cecog-installation depending on PyQt4 exists inside the site-packages
(installed by Xiwei), which cannot be removed by me, as I do not have
the permissions. So, it is important to set the PYTHONPATH
properly. This has been modified in all sh-scripts (see below).</p>
<ul class="simple">
<li>Classification of drug data with the new classifier (without any
mitocheck annotation).<ul>
<li>result folder:
<tt class="docutils literal">/share/data40T/aschoenauer/drug_screen/results_August_2016/separated_classifier</tt></li>
<li>command to generate pbs-scripts: <tt class="docutils literal">python
Cecog_script_generation_drug_screen.py <span class="pre">-b</span>
pbs_drug_screen_features_classif_August2016.py</tt></li>
<li>command to submit the jobs on the cluster:
<tt class="docutils literal">qsub <span class="pre">-t</span> <span class="pre">1-808</span> <span class="pre">-tc</span> 200
/cbio/donnees/twalter/src/drug_screen/scripts/drug_screen_new.sh</tt></li>
<li>Computation time: 5h (with 160 jobs in parallel)</li>
</ul>
</li>
<li>Classification of drug data with the combined classifier.<ul>
<li>result folder:
<tt class="docutils literal">/share/data40T/aschoenauer/drug_screen/results_August_2016/joint_classifier</tt></li>
<li>command to generate pbs-scripts: <tt class="docutils literal">python
Cecog_script_generation_drug_screen.py <span class="pre">-b</span>
pbs_drug_screen_features_classif_August2016_joint_classifier.py</tt></li>
<li>command to submit the jobs on the cluster: <tt class="docutils literal">qsub <span class="pre">-t</span> <span class="pre">1-808</span>
/cbio/donnees/twalter/src/drug_screen/scripts/joint_cl/drugs_joint_cl.sh</tt></li>
<li>Computation time: 5h (with 160 jobs in parallel)</li>
</ul>
</li>
<li>Classification of the mitocheck data with the combined classifier.<ul>
<li>I could not work on the feature data directly: working with the
existing ch5-files is faster, but I then would erase the old
classification results. Consequently, I needed to re-segment. Not
storing the features also results in a smaller data set. But it
takes longer.</li>
<li>result folder:
<tt class="docutils literal">/share/data40T/aschoenauer/drug_screen/results_August_2016/mito_joint_classifier</tt></li>
<li>command to generate pbs-scripts:
<tt class="docutils literal">python Cecog_script_generation.py <span class="pre">-b</span> pbs_mitocheck_joint_classifier.py</tt></li>
<li>command to submit the jobs on the cluster:
<tt class="docutils literal">qsub —tc 40 t <span class="pre">1-25232</span>
/cbio/donnees/twalter/src/drug_screen/scripts/mito_joint/mitojoint.sh</tt>
(yes, that's quite a number of jobs ... and tc = 40 is also not
optimal, but if I do not do this, Nelle will kill me in a most
unpleasent way ... but perhaps we can alter this next week.)</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="Alice1">
<h1>18/08/2016: Starting again</h1>
I've started to look into the data, the problems as we had discussed before the holidays and my code yesterday and today. Tough :).
<br><br>
As discussed on the 20th of August, we first would like to know whether the control phenotypic profiles in Mitocheck and the drug screen are comparable. 
As a side-check, it could be interesting to see if the control proliferation rates are similar too.
<br><br>
Let us consider the proliferation rates (easier because 1 nb/well). If the variances are equal, we can do a 2-sample t-test, otherwise a Welch's test. This
 test does not exist in scipy.stats but it exists in R. This seems reasonable. We could also look at a Kolmogorov-Smirnov test. The t-test checks if the means
 are identical, assuming the distributions are Gaussian whereas the KS test checks if the two samples are drawn from the same distribution. It seems to be
 the same goal as the Wilcoxon rank-sum test, this is interesting... Let's say we look at the three p-values and see.
<br><br>
Now when we come to phenotypic profiles. Let us assume that we consider aggregated phenotypic profiles with time (ie a vector of dimension the number of classes 
for each well). Still, this question is still the subject of papers (how to compute statistical tests between multivariate distributions - in fact this is 
precisely the reason why we needed to dvp a new approach when dealing with Motiw). Possibilities:<br>
<ul>
<li> Compute distances between DS controls on the one hand, between Mito controls on the other hand, and evaluate how the distances of DS controls to Mito controls 
compare to both latter distributions. Idea: transportation distance. Other: Hellinger, L2</li>
<li> In a similar approach, compute statistical tests (eg KS) between say 1/3 and 1/3 of DS controls, combine p-values using Fisher formula. Repeat a certain 
number of times => get a distribution of Fisher statistics. Do the same for Mitocheck controls. Finally, look at the Fisher statistics of comparisons between 
DS and Mito controls => are they consistent with the two others?</li>
</ul>
  
<div class="section" id="Alice2">
<h1>19/08/2016</h1>
<p>Done the tests for comparing proliferation: significantly different according to KS and Wilcoxon rank-sum tests, ie control proliferation values from the DS experiments do
 not come from the same distribution as those from the Mitocheck experiments. This is at least something to know, although it does not mean that the rest is bound to fail. </p>
 <img src="control_proliferation_comparison.png" width="50%">
 
 <p>If I look at the percentages of interphase at the beginning of experiments or the end, using the separated classifier for DS experiments, it is not really better, for example at t=48h:<br>
In [97]: ks_2samp(ds_interphasee, mito_interphasee[:len(ds)])<br>
Out[97]: Ks_2sampResult(statistic=0.40404040404040403, pvalue=1.0206950980453439e-07)<br>

In [98]: ks_2samp(mito_interphasee[-len(ds):], mito_interphasee[:len(ds)])<br>
Out[98]: Ks_2sampResult(statistic=0.090909090909090912, pvalue=0.78901374540865998)<br><br>
or t=0:<br>
n [77]: ks_2samp(ds_interphase, mito_interphase[:len(ds)])<br>
Out[77]: Ks_2sampResult(statistic=0.31313131313131315, pvalue=8.3404989489022121e-05)<br>

In [78]: ks_2samp(mito_interphase[-len(ds):], mito_interphase[:len(ds)])<br>
Out[78]: Ks_2sampResult(statistic=0.15151515151515149, pvalue=0.18845568511626737)<br>

It seems better using the joint classifier (from p-values 10^-7 to 10^-4), though still significantly different. The Wilcoxon rank-sum test seems lest stringent.
<br>I choose to look at the results of using the Mitocheck classifier on the DS experiments (indeed we hadn't done any tests). Restricting myself to aggregated interphases, 
it is not statistically significantly different from using the joint classifier. But the distribution is not the same than that of Mitocheck control experiments. 
<br>
<img src="control_aggregated_interphase_comparison.png"  width="50%">
<br>
If we have less interphases in the DS controls and the proliferation there is higher, I would say that the difference is therefore that there are more mitotic phenotypes in DS controls. 
If I look at the phenotypes there should be more anaphases, metaphases and prometaphases. This is correct, but does not explain all the differences: there is approximately twice as many 
mitotic phases in the DS than in Mitocheck but it is not enough to compensate for the difference. I look at Kidney, apoptosis: this seems like an endless quest which can be summarized by
 fact that the classifications were realized with a different classifier. Now. The idea is to look at Mitocheck controls which have already been computed using the joint classifier: do we still 
get that?
 </p>
<p>Indeed we do: let us investigate how each phenotypic class is represented in controls from DS and Mitocheck experiments. Here are the mean percentages over the whole movie (ie, 
aggregated data) for each phenotypic class using the joint classifier, respectively for DS and Mitocheck experiments:<br>
Interphase 0.819165420184 0.722449957794<br>
Artefact 0.03173882151 0.0426910468146<br>
Prometaphase 0.0131205009216 0.00536043444377<br>
Grape 0.00495739132674 0.000731442059825<br>
Metaphase 0.009350975884 0.00690633688488<br>
Apoptosis 0.00540172419196 0.0120680089453<br>
ADCCM 6.98284091886e-05 0.000809520079249<br>
Folded 0.000676337182389 0.00431211612777<br>
Focus 0.00151579060649 0.03098032268<br>
Large 0.00794003542958 0.00962848565439<br>
Binucleated 0.00692017149368 0.0891532008123<br>
SmallIrregular 0.00128074001242 0.014103716939<br>
Kidney 0.0413329361264 0.00155639172893<br>
Polylobed 0.0204667768705 0.0188442742433<br>
Hole 0.000292390851477 0.000973719038307<br>
Anaphase 0.0234266377098 0.0179796640158<br>
MetaphaseAlignment 0.00310661056638 0.00301602570327<br>
Elongated 0.00923691072363 0.0184353360356<br>
So on the one hand there are more interphase and kidney nuclei in the DS controls, on the other hand this is compensated by more out of focus, binucleated and small iregular 
nuclei in the Mitocheck controls. We do have more mitotic nuclei in the DS controls than in the Mitocheck controls but this is not the main effect. Therefore, it does not seem 
that the Mitocheck and DS experiments are directly comparable...</p>

In conclusion two consequences:<br>
<ul>
<li>We can still work on the distances between drug screen experiments themselves.</li>
<li>If we want to compare Mitocheck and DS experiments, we need to find a way to take the basal differences between the controls, into account.</li>
</ul>
<div class="section" id="Alice3">
<h1>23/08/2016</h1>
Point à Curie.

<div class="section" id="Alice4">
<h1>24/08/2016</h1>
Comparing the old (Mitocheck only) and joint classifiers on Mitocheck aggregated percentages of phenotypes. In h5 files corresponding to 
the original Mitocheck classifier, I think that Shape1 and Shape3 correspond to Binucleated and Polylobed (or the inverse). This explains 
why there are no Shape1, Shape3 in the Mitocheck+joint, and no Polylobed, Binucleated in the Mitocheck+old.
<table>
<tr>
<th>Phenotype </th> <th> DS ctrls </th><th> Mitocheck ctrls + old </th><th> Mitocheck+joint </th>   
<tr>
<td>  ADCCM  </td> <td>  0.01  </td> <td>  0.11  </td> <td>  0.08  </td>
</tr><tr>
<td>  Anaphase  </td> <td>  2.34  </td> <td>  1.68  </td> <td>  1.80  </td>
</tr><tr>
<td>  Apoptosis  </td> <td>  0.54  </td> <td>  1.41  </td> <td>  1.21  </td>
</tr><tr>
<td>  Artefact  </td> <td>  3.17  </td> <td>  0.45  </td> <td>  4.27  </td>
</tr><tr>
<td>  Binucleated  </td> <td>  0.69  </td> <td>  0.00  </td> <td>  8.92  </td>
</tr><tr>
<td>  Polylobed  </td> <td>  2.05  </td> <td>  0.00  </td> <td>  1.88  </td>
</tr><tr>
<td>  Shape1  </td> <td>  0.00  </td> <td>  3.76  </td> <td>  0.00  </td>
</tr><tr>
<td>  Shape3  </td> <td>  0.00  </td> <td>  2.72  </td> <td>  0.00  </td>
</tr><tr>

<td>  Elongated  </td> <td>  0.92  </td> <td>  0.63  </td> <td>  1.84  </td>
</tr><tr>
<td>  Focus  </td> <td>  0.15  </td> <td>  0.84  </td> <td>  3.10  </td>
</tr><tr>
<td>  Folded  </td> <td>  0.07  </td> <td>  0.32  </td> <td>  0.43  </td>
</tr><tr>
<td>  Grape  </td> <td>  0.50  </td> <td>  0.07  </td> <td>  0.07  </td>
</tr><tr>
<td>  Hole  </td> <td>  0.03  </td> <td>  0.10  </td> <td>  0.10  </td>
</tr><tr>
<td>  Interphase  </td> <td>  81.92  </td> <td>  84.43  </td> <td>  72.24  </td>
</tr><tr>
<td>  Kidney  </td> <td>  4.13  </td> <td>  0.00  </td> <td>  0.16  </td>
</tr><tr>
<td>  Large  </td> <td>  0.79  </td> <td>  1.05  </td> <td>  0.96  </td>
</tr><tr>
<td>  Metaphase  </td> <td>  0.94  </td> <td>  0.70  </td> <td>  0.69  </td>
</tr><tr>
<td>  MetaphaseAlignment  </td> <td>  0.31  </td> <td>  0.40  </td> <td>  0.30  </td>
</tr><tr>

<td>  Prometaphase  </td> <td>  1.31  </td> <td>  0.50  </td> <td>  0.54  </td>
</tr><tr>

<td>  SmallIrregular  </td> <td>  0.13  </td> <td>  0.75  </td> <td>  1.41  </td>
</tr><tr>
<td>  UndefinedCondensed  </td> <td>  0.00  </td> <td>  0.07  </td> <td>  0.00  </td>
</tr>
</table>
<p>
What I think is doable is to characterize each condition by the Mann-Whitney U statistic to the controls of 
the same plate, for each phenotype. There are 7 controls per plate for Mitocheck whereas there are 33 controls 
per plate for the drug screen, so this needs to be taken into account when doing the statistics. It has the 
advantage over other tests that it is one-sided, hence we retain in the statistic whether there are more or less 
of a given phenotype in the experiment.
</p>

<p>My idea is to start by looking at Mitocheck selected wells as in my PhD thesis. I add a script to search if there are 
wells with extra kidney nuclei in the rest of Mitocheck. </p>

<p>We can still use the transportation distance if we would like to look for a clustering of drug screen conditions.</p>
</div>
</body>
</html>
